<!DOCTYPE html>
<html>
<head>
    <title>Velgram Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-950 text-white p-6 md:p-12">
    <div class="max-w-2xl mx-auto space-y-8">
        <h1 class="text-3xl font-black text-blue-500 border-b border-white/10 pb-4">Velgram Admin Panel</h1>
        
        <div class="grid grid-cols-3 gap-4">
            <div class="bg-slate-900 p-6 rounded-2xl border border-white/5">
                <p class="text-xs text-slate-500 uppercase font-bold">Users</p>
                <h2 id="u-count" class="text-3xl font-bold">--</h2>
            </div>
            <div class="bg-slate-900 p-6 rounded-2xl border border-white/5">
                <p class="text-xs text-slate-500 uppercase font-bold">Channels</p>
                <h2 id="c-count" class="text-3xl font-bold">--</h2>
            </div>
            <div class="bg-slate-900 p-6 rounded-2xl border border-white/5">
                <p class="text-xs text-slate-500 uppercase font-bold">Ads</p>
                <h2 id="a-count" class="text-3xl font-bold text-emerald-500">--</h2>
            </div>
        </div>

        <div class="bg-slate-900 p-8 rounded-3xl border border-white/5 space-y-4">
            <h3 class="font-bold">Broadcast Message (All Users)</h3>
            <textarea id="msg" placeholder="Write message or link..." class="w-full bg-slate-950 border border-white/10 p-4 rounded-xl h-32 outline-none focus:border-blue-500"></textarea>
            <button onclick="send()" class="w-full bg-blue-600 py-4 rounded-xl font-bold hover:bg-blue-500 transition">Send Notification Now</button>
        </div>
    </div>

    <script>
        const pw = prompt("Enter Admin Password:");
        async function load() {
            const r = await fetch(`/api/admin/stats?pw=${pw}`);
            const d = await r.json();
            if(d.error) return alert("Unauthorized!");
            document.getElementById('u-count').innerText = d.users;
            document.getElementById('c-count').innerText = d.channels;
            document.getElementById('a-count').innerText = d.ads;
        }
        async function send() {
            const msg = document.getElementById('msg').value;
            const r = await fetch('/api/admin/broadcast', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({pass: pw, msg: msg})
            });
            const d = await r.json();
            alert(d.message);
        }
        load();
    </script>
</body>
</html>
